<!--
  Generated template for the FeedPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar color="primary">
    <ion-title>Feed</ion-title>
  </ion-navbar>

</ion-header>


<ion-content>
  <section class="status-card" *ngFor="let post of posts">
    <div *ngIf="post.content.type == 'text'">
      <ion-item-divider sticky no-lines (click)="getPost()">
        <ion-avatar item-start>
          <img class="no-resize" [src]="post.profileImgURL || 'assets/imgs/logo/profile.png'">
        </ion-avatar>
        <h2 class="post-username">{{post.userName}}
          <span *ngIf="post.isShared"> shared 
            <span *ngIf="post.originalUid == post.uid">his own post </span>
            <span *ngIf="post.originalUid != post.uid">{{post.originalUserName}}'s post </span> </span>
        </h2>
        <p>{{post.createdAt | formatDate}}</p>
      </ion-item-divider>
      <div class="post-content" [ngStyle]="{'background': post.content.color}" (click)="showPostDetail(post)">
        <p class="text">{{post.content.text}}</p>
      </div>
      <button class="button-like" ion-button icon-only round small [color]="(userLikedPost[post.key] === true?'primary':'light')"
        (click)="likePost(post.key,post.likeCount, userLikedPost[post.key] != true)">
        <ion-icon name="thumbs-up"></ion-icon>
      </button>
      <button class="button-share" ion-button icon-only round small outline [color]="'primary'" (click)="sharePost(post)">
        <ion-icon name="share"></ion-icon>
      </button>
    </div>
    <div *ngIf="post.content.type == 'image'">
      <ion-item-divider sticky no-lines (click)="getPost()">
        <ion-avatar item-start>
          <img class="no-resize" [src]="post.profileImgURL">
        </ion-avatar>
        <h2 class="post-username">{{post.userName}}</h2>
        <p>{{post.content.createdAt | formatDate}}</p>
      </ion-item-divider>
      <div (click)="showPostDetail(post)">
        <p class="text-padding-left">{{post.content.text}}</p>
        <img class="post-img" [src]=" post.content.image">
      </div>
      <button class="button-like" ion-button icon-only round small [color]="(userLikedPost[post.key] === true?'primary':'light')"
        (click)="likePost(post.key,post.likeCount, userLikedPost[post.key] != true)">
        <ion-icon name="thumbs-up"></ion-icon>
      </button>
      <button class="button-share" ion-button icon-only round small outline [color]="'primary'" (click)="sharePost(post)">
        <ion-icon name="share"></ion-icon>
      </button>
    </div>
  </section>

  <!-- <ion-infinite-scroll (ionInfinite)="doInfinite($event)">
    <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="Loading more data...">
    </ion-infinite-scroll-content>
  </ion-infinite-scroll> -->
  <!-- <button ion-button block button-center (click)="loadMore()" color="light">Load more</button> -->
  <ion-fab top right edge #fab>
    <button ion-fab color="secondary">
      <ion-icon name="add"></ion-icon>
    </button>
    <ion-fab-list>
      <button ion-fab color="light" (click)="goToPost('text',fab)">
        <ion-icon name="list"></ion-icon>
      </button>
      <button ion-fab color="dark" (click)="goToPost('image', fab)">
        <ion-icon name="camera"></ion-icon>
      </button>
      <!-- <button ion-fab color="danger" (click)="goToPost('video', fab)">
        <ion-icon name="logo-youtube"></ion-icon>
      </button> -->
    </ion-fab-list>
  </ion-fab>

</ion-content>